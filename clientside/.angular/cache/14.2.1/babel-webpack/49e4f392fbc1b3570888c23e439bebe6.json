{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/post.service\";\nimport * as i2 from \"../../service/image-upload.service\";\nimport * as i3 from \"../../service/notification.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/material/button\";\nexport let AddPostComponent = /*#__PURE__*/(() => {\n  class AddPostComponent {\n    constructor(postService, imageUploadService, notificationService, router, fb) {\n      this.postService = postService;\n      this.imageUploadService = imageUploadService;\n      this.notificationService = notificationService;\n      this.router = router;\n      this.fb = fb;\n      this.isPostCreated = false;\n    }\n\n    ngOnInit() {\n      this.postForm = this.createPostForm();\n    }\n\n    createPostForm() {\n      return this.fb.group({\n        title: ['', Validators.compose([Validators.required])],\n        caption: ['', Validators.compose([Validators.required])],\n        location: ['', Validators.compose([Validators.required])]\n      });\n    }\n\n    submit() {\n      this.postService.createPost({\n        title: this.postForm.value.title,\n        caption: this.postForm.value.caption,\n        location: this.postForm.value.location\n      }).subscribe(data => {\n        this.createdPost = data;\n        console.log(data);\n\n        if (this.createdPost.id != null) {\n          this.imageUploadService.uploadImageToPost(this.selectedFile, this.createdPost.id).subscribe(() => {\n            this.notificationService.showSnackBar('Post created successfully');\n            this.isPostCreated = true;\n            this.router.navigate(['/profile']);\n          });\n        }\n      });\n    }\n\n    onFileSelected(event) {\n      this.selectedFile = event.target.files[0];\n      const reader = new FileReader();\n      reader.readAsDataURL(this.selectedFile);\n\n      reader.onload = e => {\n        this.previewImgURL = reader.result;\n      };\n    }\n\n  }\n\n  AddPostComponent.ɵfac = function AddPostComponent_Factory(t) {\n    return new (t || AddPostComponent)(i0.ɵɵdirectiveInject(i1.PostService), i0.ɵɵdirectiveInject(i2.ImageUploadService), i0.ɵɵdirectiveInject(i3.NotificationService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.FormBuilder));\n  };\n\n  AddPostComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddPostComponent,\n    selectors: [[\"app-add-post\"]],\n    decls: 27,\n    vars: 3,\n    consts: [[2, \"text-align\", \"right\"], [\"mat-flat-button\", \"\", \"color\", \"primary\", \"routerLink\", \"/profile\"], [3, \"formGroup\"], [\"alt\", \"user image\", 1, \"post-image\", 3, \"src\"], [\"type\", \"file\", 2, \"display\", \"none\", 3, \"change\"], [\"fileInput\", \"\"], [\"mat-button\", \"\", 3, \"click\"], [\"appearance\", \"outline\", 1, \"w-100\"], [\"matInput\", \"\", \"formControlName\", \"title\"], [\"matInput\", \"\", \"formControlName\", \"caption\"], [\"matInput\", \"\", \"formControlName\", \"location\"], [\"mat-flat-button\", \"\", \"color\", \"primary\", 3, \"disabled\", \"click\"]],\n    template: function AddPostComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r1 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\")(1, \"div\", 0)(2, \"button\", 1);\n        i0.ɵɵtext(3, \"My Posts\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"h2\");\n        i0.ɵɵtext(5, \"Create Post\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"form\", 2);\n        i0.ɵɵelement(7, \"img\", 3);\n        i0.ɵɵelementStart(8, \"input\", 4, 5);\n        i0.ɵɵlistener(\"change\", function AddPostComponent_Template_input_change_8_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"button\", 6);\n        i0.ɵɵlistener(\"click\", function AddPostComponent_Template_button_click_10_listener() {\n          i0.ɵɵrestoreView(_r1);\n\n          const _r0 = i0.ɵɵreference(9);\n\n          return i0.ɵɵresetView(_r0.click());\n        });\n        i0.ɵɵtext(11, \"Pick File\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"mat-form-field\", 7)(13, \"mat-label\");\n        i0.ɵɵtext(14, \"Title\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"input\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"mat-form-field\", 7)(17, \"mat-label\");\n        i0.ɵɵtext(18, \"Caption\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(19, \"input\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"mat-form-field\", 7)(21, \"mat-label\");\n        i0.ɵɵtext(22, \"Location\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(23, \"input\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 0)(25, \"button\", 11);\n        i0.ɵɵlistener(\"click\", function AddPostComponent_Template_button_click_25_listener() {\n          return ctx.submit();\n        });\n        i0.ɵɵtext(26, \" Create Post \");\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"formGroup\", ctx.postForm);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"src\", ctx.previewImgURL || \"https://www.missingdogsuk.co.uk/wp-content/plugins/wp-job-manager-resumes/assets/images/candidate.png\", i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(18);\n        i0.ɵɵproperty(\"disabled\", ctx.postForm.invalid);\n      }\n    },\n    dependencies: [i4.RouterLink, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.FormGroupDirective, i5.FormControlName, i6.MatFormField, i6.MatLabel, i7.MatInput, i8.MatButton],\n    styles: [\".post-image[_ngcontent-%COMP%]{display:block;margin:1rem auto;width:200px;height:200px}\"]\n  });\n  return AddPostComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}